#!/bin/sh

#####################################################
#            BSPWM Configuration                    #
#            Cyberpunk Theme - 1920x1080            #
#####################################################

# ─────────────────────────────────────────────────────
# Monitor y Workspaces (números simples)
# ─────────────────────────────────────────────────────
bspc monitor -d 1 2 3 4 5 6 7 8 9 10

# ─────────────────────────────────────────────────────
# Configuración Global de BSPWM
# ─────────────────────────────────────────────────────
bspc config border_width            2
bspc config window_gap              8
bspc config top_padding             30
bspc config bottom_padding          5
bspc config left_padding            5
bspc config right_padding           5

bspc config split_ratio             0.52
bspc config borderless_monocle      true
bspc config gapless_monocle         true
bspc config single_monocle          true

# IMPORTANTE: Desactivar focus_follows_pointer puede mejorar rendimiento
bspc config focus_follows_pointer   false
bspc config pointer_follows_focus   false
bspc config pointer_follows_monitor false

bspc config remove_disabled_monitors    true
bspc config remove_unplugged_monitors   true

# Reducir carga de eventos
bspc config ignore_ewmh_focus       true

# ─────────────────────────────────────────────────────
# Colores de Bordes
# ─────────────────────────────────────────────────────
bspc config normal_border_color     "#1a1b26"
bspc config active_border_color     "#bb9af7"
bspc config focused_border_color    "#7aa2f7"
bspc config presel_feedback_color   "#9ece6a"

# ─────────────────────────────────────────────────────
# Reglas de Aplicaciones
# ─────────────────────────────────────────────────────
bspc rule -a Firefox desktop='^2' follow=on
bspc rule -a firefox-esr desktop='^2' follow=on
bspc rule -a Thunar desktop='^4' follow=on
bspc rule -a File-roller state=floating
bspc rule -a Lxappearance state=floating
bspc rule -a Pavucontrol state=floating
bspc rule -a feh state=floating
bspc rule -a mpv state=floating

# ─────────────────────────────────────────────────────
# Autostart - OPTIMIZADO
# ─────────────────────────────────────────────────────

# Matar procesos previos de forma segura
killall -q sxhkd 2>/dev/null
killall -q polybar 2>/dev/null
killall -q picom 2>/dev/null
killall -q dunst 2>/dev/null

# Esperar a que terminen
sleep 0.3

# Cursor
xsetroot -cursor_name left_ptr &

# SXHKD - Hotkeys (ESENCIAL)
sxhkd &

# Picom - Solo si quieres bordes redondeados
# COMENTA ESTA LÍNEA SI SIGUE LENTO:
picom --config $HOME/.config/picom/picom.conf &

# Polybar
$HOME/.config/polybar/launch.sh &

# Dunst (notificaciones - opcional)
# dunst &

# Wallpaper
if [ -f "$HOME/wallpapers/2151158655.jpg" ]; then
    feh --bg-fill "$HOME/wallpapers/2151158655.jpg" &
elif [ -f "$HOME/wallpapers/2151160587.jpg" ]; then
    feh --bg-fill "$HOME/wallpapers/2151160587.jpg" &
fi

# Policy Kit
/usr/lib/policykit-1-gnome/polkit-gnome-authentication-agent-1 &

# Fix Java
export _JAVA_AWT_WM_NONREPARENTING=1
