#################################
#    PICOM - PERFORMANCE MODE   #
#    Optimizado para VM/Kali    #
#    Polybar-Safe Config        #
#################################

# ═══════════════════════════════════════════════════
# BACKEND - xrender para VMs
# ═══════════════════════════════════════════════════
backend = "xrender";

# ═══════════════════════════════════════════════════
# VSYNC
# ═══════════════════════════════════════════════════
vsync = false;

# ═══════════════════════════════════════════════════
# BORDES REDONDEADOS (solo ventanas, no polybar)
# ═══════════════════════════════════════════════════
corner-radius = 10;

rounded-corners-exclude = [
    "window_type = 'desktop'",
    "window_type = 'dock'",
    "class_g = 'Polybar'"
];

# ═══════════════════════════════════════════════════
# SOMBRAS - Ligeras para ventanas (no polybar)
# ═══════════════════════════════════════════════════
shadow = true;
shadow-radius = 12;
shadow-offset-x = -5;
shadow-offset-y = -5;
shadow-opacity = 0.3;

shadow-exclude = [
    "class_g = 'Polybar'",
    "name = 'Polybar'",
    "window_type = 'dock'",
    "window_type = 'desktop'",
    "_GTK_FRAME_EXTENTS@:c",
    "_NET_WM_WINDOW_TYPE:a *= 'DOCK'"
];

# ═══════════════════════════════════════════════════
# FADING - Suave
# ═══════════════════════════════════════════════════
fading = true;
fade-in-step = 0.03;
fade-out-step = 0.03;
fade-delta = 5;

fade-exclude = [
    "class_g = 'Polybar'",
    "name = 'Polybar'",
    "window_type = 'dock'"
];

# ═══════════════════════════════════════════════════
# TRANSPARENCIA
# ═══════════════════════════════════════════════════
inactive-opacity = 1.0;
active-opacity = 1.0;
frame-opacity = 1.0;
inactive-opacity-override = false;

opacity-rule = [
    "100:class_g = 'Polybar'",
    "100:window_type = 'dock'"
];

# ═══════════════════════════════════════════════════
# CONFIGURACIÓN DE RENDIMIENTO
# ═══════════════════════════════════════════════════
use-damage = true;

# IMPORTANTE: Desactivar unredir para evitar problemas con polybar
unredir-if-possible = false;

mark-wmwin-focused = true;
# CRÍTICO: false para no tocar ventanas override-redirect (polybar)
mark-ovredir-focused = false;
detect-rounded-corners = true;
detect-client-opacity = true;
detect-transient = true;
use-ewmh-active-win = true;

blur-background = false;
log-level = "error";

# ═══════════════════════════════════════════════════
# FOCUS EXCLUDE - Polybar nunca pierde "focus visual"
# ═══════════════════════════════════════════════════
focus-exclude = [
    "class_g = 'Polybar'",
    "name = 'Polybar'",
    "window_type = 'dock'",
    "_NET_WM_WINDOW_TYPE:a *= 'DOCK'"
];

# ═══════════════════════════════════════════════════
# WINTYPES - Dock (polybar) sin efectos
# ═══════════════════════════════════════════════════
wintypes:
{
    tooltip = { fade = true; shadow = false; opacity = 0.9; };
    dock = { 
        shadow = false; 
        fade = false;
        opacity = 1.0;
        focus = true;
        full-shadow = false;
        clip-shadow-above = false;
    };
    dnd = { shadow = false; };
    popup_menu = { shadow = true; opacity = 0.95; };
    dropdown_menu = { shadow = true; opacity = 0.95; };
    normal = { shadow = true; };
};
